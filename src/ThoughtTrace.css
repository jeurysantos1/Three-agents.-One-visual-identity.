/* ─────────────────────────────────────────────────────────────────────────────
   THOUGHTTRACE — Material Design 3 (Material You)
   - clearer hierarchy (active vs done vs locked)
   - tonal surfaces + elevation
   - Material Symbols friendly
   - dark mode + reduced motion
   ───────────────────────────────────────────────────────────────────────────── */

.tt-root {
  /* Shape */
  --md-sys-shape-corner-small: 8px;
  --md-sys-shape-corner-medium: 12px;
  --md-sys-shape-corner-large: 16px;
  --md-sys-shape-corner-full: 999px;

  /* Motion */
  --md-sys-motion-duration-short1: 50ms;
  --md-sys-motion-duration-short2: 100ms;
  --md-sys-motion-duration-medium1: 200ms;
  --md-sys-motion-duration-medium2: 300ms;
  --md-sys-motion-duration-long: 500ms;

  --md-sys-motion-easing-standard: cubic-bezier(0.2, 0, 0, 1);
  --md-sys-motion-easing-decelerate: cubic-bezier(0, 0, 0, 1);
  --md-sys-motion-easing-accelerate: cubic-bezier(0.3, 0, 1, 1);
  --md-sys-motion-easing-emphasized: cubic-bezier(0.2, 0, 0, 1);

  /* State layers */
  --md-sys-state-hover-opacity: 0.08;
  --md-sys-state-pressed-opacity: 0.12;
  --md-sys-state-focus-opacity: 0.12;

  /* Tonal surfaces (light) */
  --tt-surface: #ffffff;
  --tt-surface-dim: rgba(0, 0, 0, 0.02);
  --tt-surface-container-low: rgba(0, 0, 0, 0.03);
  --tt-surface-container: rgba(0, 0, 0, 0.05);
  --tt-surface-container-high: rgba(0, 0, 0, 0.08);
  --tt-outline-variant: rgba(0, 0, 0, 0.12);

  --tt-on-surface: #1c1b1f;
  --tt-on-surface-variant: #49454f;

  /* Accent (you can override inline per-step) */
  --tt-accent: #6750a4; /* default-ish M3 primary */

  width: 100%;
}

/* Dark mode */
@media (prefers-color-scheme: dark) {
  .tt-root {
    --tt-surface: #121212;
    --tt-surface-dim: rgba(255, 255, 255, 0.04);
    --tt-surface-container-low: rgba(255, 255, 255, 0.06);
    --tt-surface-container: rgba(255, 255, 255, 0.08);
    --tt-surface-container-high: rgba(255, 255, 255, 0.12);
    --tt-outline-variant: rgba(255, 255, 255, 0.14);

    --tt-on-surface: rgba(255, 255, 255, 0.92);
    --tt-on-surface-variant: rgba(255, 255, 255, 0.70);
  }
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce) {
  .tt-root * {
    animation: none !important;
    transition: none !important;
  }
}

/* ── HEADER ─────────────────────────────────────────────────────────────── */

.tt-header {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 10px;
  padding: 0 4px;
  min-height: 28px;
}

.tt-header-dot {
  width: 8px;
  height: 8px;
  border-radius: var(--md-sys-shape-corner-full);
  background: var(--tt-accent);
  opacity: 0.8;
}

.tt-header-label {
  font-size: 11px;
  font-weight: 600;
  letter-spacing: 0.06em;
  color: var(--tt-on-surface-variant);
}

.tt-header-badge {
  margin-left: auto;
  font-size: 10px;
  font-weight: 600;
  letter-spacing: 0.04em;
  padding: 4px 10px;
  border-radius: var(--md-sys-shape-corner-full);
  background: var(--tt-surface-container-low);
  color: var(--tt-on-surface-variant);
  border: 1px solid var(--tt-outline-variant);
}

.tt-badge-live {
  position: relative;
}

.tt-badge-live::after {
  content: "";
  display: inline-block;
  width: 6px;
  height: 6px;
  margin-left: 6px;
  border-radius: var(--md-sys-shape-corner-full);
  background: var(--tt-accent);
  opacity: 0.8;
  animation: tt-live-pulse 1.8s var(--md-sys-motion-easing-standard) infinite;
}

@keyframes tt-live-pulse {
  0%, 100% { transform: scale(1); opacity: 0.9; }
  50% { transform: scale(0.7); opacity: 0.35; }
}

/* ── LIST ───────────────────────────────────────────────────────────────── */

.tt-list {
  list-style: none;
  margin: 0;
  padding: 0;
  display: flex;
  flex-direction: column;
  gap: 6px; /* more breathing room */
}

/* ── STEP ITEM ─────────────────────────────────────────────────────────── */

.tt-step {
  border-radius: var(--md-sys-shape-corner-large);
  position: relative;
  overflow: hidden;
  border: 1px solid transparent;
  background: transparent;
  transition:
    background var(--md-sys-motion-duration-medium1) var(--md-sys-motion-easing-standard),
    border-color var(--md-sys-motion-duration-medium1) var(--md-sys-motion-easing-standard),
    transform var(--md-sys-motion-duration-short2) var(--md-sys-motion-easing-emphasized),
    box-shadow var(--md-sys-motion-duration-medium1) var(--md-sys-motion-easing-standard);
}

.tt-step--active {
  background: var(--tt-surface-container);
  border-color: var(--tt-outline-variant);
  box-shadow: 0 6px 18px rgba(0,0,0,0.08);
  transform: translateY(-1px);
}

.tt-step--done:not(.tt-step--active) {
  background: var(--tt-surface-dim);
  border-color: var(--tt-outline-variant);
}

.tt-step--locked {
  opacity: 0.72;
  pointer-events: none;
}

/* ── ROW BUTTON (touch target + clarity) ───────────────────────────────── */

.tt-row {
  position: relative;
  display: flex;
  align-items: center;
  gap: 12px;
  width: 100%;
  min-height: 48px;         /* closer to Material touch target */
  padding: 10px 12px;
  background: none;
  border: none;
  border-radius: inherit;
  text-align: left;
  font-family: inherit;
  cursor: pointer;
  outline: none;
  color: var(--tt-on-surface);
  overflow: hidden;
}

/* State layer overlay */
.tt-row::before {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: inherit;
  background: currentColor;
  opacity: 0;
  transition: opacity var(--md-sys-motion-duration-short2) var(--md-sys-motion-easing-standard);
  pointer-events: none;
}

.tt-row:hover::before { opacity: var(--md-sys-state-hover-opacity); }
.tt-row:active::before { opacity: var(--md-sys-state-pressed-opacity); }

.tt-row:focus-visible {
  outline: 2px solid var(--tt-accent);
  outline-offset: 3px;
}

/* ── LEADING ICON (Material Symbols friendly) ───────────────────────────── */

.tt-icon {
  width: 28px;
  height: 28px;
  border-radius: var(--md-sys-shape-corner-full);
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;

  background: var(--tt-surface-container-high);
  color: var(--tt-on-surface-variant);

  transition:
    background var(--md-sys-motion-duration-medium1) var(--md-sys-motion-easing-standard),
    color var(--md-sys-motion-duration-medium1) var(--md-sys-motion-easing-standard),
    transform var(--md-sys-motion-duration-medium2) var(--md-sys-motion-easing-emphasized);
}

/* Active: accent */
.tt-step--active .tt-icon {
  background: color-mix(in srgb, var(--tt-accent) 18%, var(--tt-surface-container-high));
  color: var(--tt-accent);
  transform: scale(1.06);
}

/* Done: stronger success-like treatment (still neutral if you prefer) */
.tt-step--done .tt-icon {
  background: var(--tt-surface-container-high);
  color: var(--tt-on-surface);
}

/* If you keep the old text check/num inside */
.tt-check { font-size: 11px; font-weight: 800; line-height: 1; }
.tt-num { font-size: 10px; font-weight: 700; line-height: 1; opacity: 0.7; }

/* Material Symbols inside the icon */
.tt-ms {
  font-family: "Material Symbols Rounded";
  font-weight: 500;
  font-style: normal;
  font-size: 18px;
  line-height: 1;
  letter-spacing: normal;
  text-transform: none;
  display: inline-block;
  white-space: nowrap;
  word-wrap: normal;
  direction: ltr;
  -webkit-font-smoothing: antialiased;
}

/* Spinner (slightly bigger for readability) */
.tt-spinner {
  width: 12px;
  height: 12px;
  border-radius: var(--md-sys-shape-corner-full);
  border: 2px solid currentColor;
  border-top-color: transparent;
  animation: tt-spin 0.7s linear infinite;
}

@keyframes tt-spin { to { transform: rotate(360deg); } }

/* ── LABEL ─────────────────────────────────────────────────────────────── */

.tt-label {
  flex: 1;
  font-size: 13px;          /* slightly bigger = clearer */
  font-weight: 500;         /* more “Google” baseline */
  line-height: 1.35;
  letter-spacing: 0.01em;
  color: var(--tt-on-surface);
}

.tt-step--done .tt-label {
  color: var(--tt-on-surface-variant);
  font-weight: 500;
}

.tt-step--locked .tt-label {
  opacity: 0.55;
}

/* ── TRAILING CHEVRON ─────────────────────────────────────────────────── */

.tt-chevron {
  width: 24px;
  height: 24px;
  display: grid;
  place-items: center;
  border-radius: var(--md-sys-shape-corner-full);
  color: var(--tt-on-surface-variant);
  opacity: 0.8;
  transition:
    transform var(--md-sys-motion-duration-medium2) var(--md-sys-motion-easing-emphasized),
    opacity var(--md-sys-motion-duration-short2) var(--md-sys-motion-easing-standard);
}

.tt-row:hover .tt-chevron { opacity: 1; }

/* ── DETAIL PANEL ─────────────────────────────────────────────────────── */

.tt-detail {
  display: flex;
  gap: 12px;
  margin: 0 8px 8px;
  padding: 12px 14px;
  background: var(--tt-surface-container-low);
  border: 1px solid var(--tt-outline-variant);
  border-radius: 0 0 var(--md-sys-shape-corner-large) var(--md-sys-shape-corner-large);
  animation: tt-expand var(--md-sys-motion-duration-medium2) var(--md-sys-motion-easing-decelerate);
  transform-origin: top center;
}

@keyframes tt-expand {
  from { opacity: 0; transform: translateY(-6px) scaleY(0.92); }
  to   { opacity: 1; transform: translateY(0) scaleY(1); }
}

.tt-detail-accent {
  width: 3px;
  border-radius: 3px;
  flex-shrink: 0;
  background: var(--tt-accent);
  opacity: 0.55;
}

.tt-detail-text {
  margin: 0;
  font-size: 12px;
  line-height: 1.7;
  color: var(--tt-on-surface-variant);
}


/* ─────────────────────────────────────────────────────────────────────────────
   HYBRID "C" ADDITIONS — inline cognition + icon motion
   Works with existing M3 styling above.
   ───────────────────────────────────────────────────────────────────────────── */

.tt-header__left{
  display:flex;
  flex-direction:column;
  gap:2px;
}
.tt-header__title{
  font-size: 12.5px;
  font-weight: 780;
  letter-spacing: 0.02em;
  color: var(--tt-on-surface);
}
.tt-header__meta{
  font-size: 12px;
  color: var(--tt-on-surface-variant);
}

.tt-list{
  display:flex;
  flex-direction:column;
  gap: 10px;
}

.tt-body{
  display:flex;
  flex-direction:column;
  gap: 4px;
  flex:1;
  min-width:0;
}

.tt-label{
  font-size: 12.5px;
  font-weight: 720;
  color: var(--tt-on-surface);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.tt-inline{
  font-size: 12px;
  color: var(--tt-on-surface-variant);
  opacity: 0.85;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.tt-right{
  display:flex;
  gap: 8px;
  align-items:center;
}

.tt-pill{
  font-size: 11px;
  font-weight: 800;
  padding: 4px 10px;
  border-radius: var(--md-sys-shape-corner-full);
  border: 1px solid var(--tt-outline-variant);
  background: var(--tt-surface-container-low);
  color: var(--tt-on-surface-variant);
}

.tt-pill--live{
  border-color: rgba(255,87,34,0.28);
  background: rgba(255,87,34,0.14);
  color: rgba(255,87,34,0.95);
}

.tt-pill--done{
  border-color: rgba(0,201,123,0.35);
  background: rgba(0,201,123,0.14);
  color: rgba(0,201,123,0.95);
}

/* Material Symbols helper in this component */
.tt-ms{
  font-family: "Material Symbols Rounded";
  font-weight: normal;
  font-style: normal;
  line-height: 1;
  display: inline-block;
  white-space: nowrap;
  word-wrap: normal;
  direction: ltr;
  -webkit-font-feature-settings: "liga";
  -webkit-font-smoothing: antialiased;
}

/* Synth dots inline */
.tt-synthDots{
  display:inline-flex;
  gap: 4px;
  align-items:center;
  margin-left: 8px;
}
.tt-synthDot{
  width: 6px;
  height: 6px;
  border-radius: 999px;
  background: var(--tt-on-surface-variant);
  opacity: 0.45;
  animation: ttDot 1.1s infinite;
}
.tt-synthDot:nth-child(2){ animation-delay: .15s; }
.tt-synthDot:nth-child(3){ animation-delay: .3s; }

@keyframes ttDot{
  0%,80%,100%{ transform: translateY(0); opacity: .25; }
  40%{ transform: translateY(-2px); opacity: .85; }
}

/* Hybrid mode motion via class on .tt-step */
.tt-mode--thinking .tt-ms{
  animation: ttPulse 1.8s ease-in-out infinite;
}
@keyframes ttPulse{
  0%{ transform: scale(1); opacity: .65; }
  50%{ transform: scale(1.06); opacity: 1; }
  100%{ transform: scale(1); opacity: .65; }
}

.tt-mode--processing .tt-ms{
  animation: ttSlowRotate 7s linear infinite;
}
@keyframes ttSlowRotate{
  to{ transform: rotate(360deg); }
}

.tt-mode--locking .tt-ms{
  animation: ttPop 220ms cubic-bezier(.2,0,0,1) 1;
}
@keyframes ttPop{
  0%{ transform: scale(.92); }
  60%{ transform: scale(1.10); }
  100%{ transform: scale(1); }
}

/* Reduce motion */
@media (prefers-reduced-motion: reduce){
  .tt-mode--thinking .tt-ms,
  .tt-mode--processing .tt-ms{
    animation: none !important;
  }
  .tt-synthDot{
    animation: none !important;
  }
}
